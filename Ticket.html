<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Ticket ULTRANET</title>
  <style>
    body {
      width: 250px;
      font-family: Arial, sans-serif;
      font-size: 12px;
      margin: 0;
      padding: 0;
    }
    .center {
      text-align: center;
    }
    hr {
      border: none;
      border-top: 1px dashed #000;
      margin: 6px 0;
    }
    table {
      width: 100%;
    }
    td {
      padding: 2px 0;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

  <div class="center">
    <img src="https://github.com/Jhonylux1999/Ultranet/blob/main/logo%20ultranet.png?raw=true" style="width:50px;" />
    <div><strong>ULTRANET</strong></div>
    <div>Uspantán</div>
    <div>Tel: 4964-7515 / 3767-6826</div>
    <div>ultranetsoporte7@gmail.com</div>
    <div id="Fecha"></div>
  </div>

  <hr>

  <div><strong>Datos del Cliente</strong></div>
  <table>
    <tr><td>Cliente:</td><td id="NombreCliente"></td></tr>
    <tr><td>Teléfono:</td><td id="Telefono"></td></tr>
    <tr><td>Dirección:</td><td id="Direccion"></td></tr>
  </table>

  <hr>

  <table>
    <tr><td>Plan:</td><td id="Plan"></td></tr>
    <tr><td>Mes:</td><td id="Mes"></td></tr>
    <tr><td>Total:</td><td id="Total"></td></tr>
    <tr><td>Forma de Pago:</td><td id="FormadePago"></td></tr>
  </table>

  <hr>

  <div class="center">
    ULTRANET te desea<br>
    —Éxito y muchas bendiciones—
  </div>

  <script>
    function tipoplan(p) {
      switch(p) {
        case "150": return "15 Megas";
        case "175": return "20 Megas";
        case "200": return "30 Megas";
        default: return "Plan desconocido";
      }
    }

    function poblarDatos() {
      document.getElementById('Fecha').innerText = new Date().toLocaleDateString();
      document.getElementById('NombreCliente').innerText = localStorage.getItem('NombreCliente') || '';
      document.getElementById('Telefono').innerText = localStorage.getItem('Telefono') || '';
      document.getElementById('Direccion').innerText = localStorage.getItem('Direccion') || '';
      document.getElementById('Mes').innerText = localStorage.getItem('MesPago') || '';
      document.getElementById('Total').innerText = localStorage.getItem('Plan') || '';
      document.getElementById('FormadePago').innerText = localStorage.getItem('MetodoPago') || '';
      document.getElementById('Plan').innerText = tipoplan(localStorage.getItem('Plan'));
    }

    async function generarPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({
        orientation: 'portrait',
        unit: 'px',
        format: [250, 600]
      });

      const nombre = localStorage.getItem('NombreCliente') || 'Cliente';
      const fecha = new Date().toLocaleDateString().replace(/\//g, '-');
      const nombreArchivo = `${nombre}_${fecha}.pdf`;

      await doc.html(document.body, {
        x: 10,
        y: 10,
        callback: function (doc) {
          doc.save(nombreArchivo);
        }
      });
    }

    window.onload = function() {
      poblarDatos();
      generarPDF();
    };
  </script>

</body>
</html>
